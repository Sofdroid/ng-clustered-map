"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="clustered.map"),function(e,r,t){"use strict";r.module("clustered.map",[]).factory("google",["$window",function(e){if(e.google===t||e.MarkerClusterer===t)throw new Error("google is not bound to window");return{maps:e.google.maps,MarkerClusterer:e.MarkerClusterer}}]).directive("clusteredMap",["google",function(e){return{restrict:"EA",replace:!0,template:'<div id="map_canvas"></div>',scope:{markers:"=",zoom:"=",center:"="},link:function(t,n){function o(o){for(var a=t.center||{x:0,y:0},i=0;i<o.length;i++)a.x+=o[i][0]*o[i][2],a.y+=o[i][1]*o[i][2];a.x/=o.length,a.y/=o.length;for(var s=new e.maps.LatLng(2,2),l=r.element(n[0])[0],u=new e.maps.Map(l,{zoom:t.zoom||2,center:s,mapTypeId:e.maps.MapTypeId.ROADMAP}),i=0;i<o.length;++i)o[i]=new e.maps.Marker({position:new e.maps.LatLng(o[i][0],o[i][1]),weight:o[i][2],title:"weight:"+o[i][2]});var p=function(e,r){for(var t=0,n=0;n<e.length;n++)t+=e[n].weight;return{text:t,index:Math.min(String(t).length,r)}},d=new e.MarkerClusterer(u);d.setCalculator(p),d.addMarkers(o)}t.$watch(function(){return t.markers},function(){t.markers&&o(t.markers)})}}}])}(window,window.angular);